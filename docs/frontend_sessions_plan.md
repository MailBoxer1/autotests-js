# План по обновлению фронтенда для работы с Redis-сессиями (без JWT)

---

## 1. Удалить работу с JWT

- Удалить сохранение токена в `localStorage` или `sessionStorage`.
- Удалить передачу токена в `Authorization` header при запросах.
- Удалить логику, связанную с парсингом и хранением JWT.

---

## 2. Проверка авторизации через `/api/profile`

- При запуске приложения (например, в `App.vue` или `main.ts`) сделать GET-запрос на `/api/profile`.
- Если ответ 200:
  - Пользователь авторизован.
  - Сохранить данные пользователя (email, userId) в состоянии (Vuex, Pinia, Composition API).
  - Обновить UI (показать профиль, кнопку "Выйти").
- Если ответ 401:
  - Пользователь не авторизован.
  - Показать кнопки "Войти" / "Регистрация".

---

## 3. Вход пользователя

- При успешном POST `/api/login`:
  - Сервер вернёт `{ message: 'Вход выполнен успешно' }`.
  - Сделать повторный запрос на `/api/profile` для получения данных пользователя.
  - Обновить UI.

---

## 4. Регистрация пользователя

- При успешной POST `/api/register`:
  - Сервер вернёт `{ message: 'Пользователь успешно зарегистрирован' }`.
  - Выполнить автоматический вход (как сейчас).
  - Сделать запрос `/api/profile`.
  - Обновить UI.

---

## 5. Выход пользователя

- При POST `/api/logout`:
  - Сервер уничтожит сессию.
  - Очистить состояние пользователя на фронте.
  - Обновить UI (показать "Войти" / "Регистрация").

---

## 6. Обработка ошибок

- Если при запросе `/api/profile` получен 401:
  - Считать, что пользователь не авторизован.
  - Очистить состояние пользователя.
- При ошибках входа/регистрации показывать сообщения.

---

## 7. Тестирование

- Проверить, что после входа UI обновляется.
- Проверить, что после выхода UI обновляется.
- Проверить, что при перезагрузке страницы авторизация сохраняется (cookie).
- Проверить, что без входа защищённые данные недоступны.

---

## 8. Итог

- Фронтенд больше не использует JWT.
- Авторизация основана на cookie и сессиях.
- Проверка статуса — через `/api/profile`.
- UI обновляется в зависимости от статуса авторизации.

---

## 9. Дополнительно (опционально)

- Можно добавить глобальный перехватчик ошибок (interceptor), чтобы при 401 автоматически перенаправлять на страницу входа.
- Можно использовать Vuex/Pinia для централизованного хранения состояния пользователя.
